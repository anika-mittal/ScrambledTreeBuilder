% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/esr.R
\name{computeESR}
\alias{computeESR}
\title{Compute ESR points (Excess Scrambling over a LOESS trend)}
\usage{
computeESR(
  tb,
  span = 0.7,
  family = "symmetric",
  degree = 1,
  use_weights = TRUE,
  std_mode = c("robust_global", "global_sd", "local_loess"),
  span_scale = 0.7
)
}
\arguments{
\item{tb}{A tibble produced by \code{\link{MRCAs}}}

\item{span}{LOESS span for the mean trend (default 0.7).}

\item{family}{LOESS family; \code{"symmetric"} is robust to outliers (default).}

\item{degree}{Local polynomial degree for LOESS (1 = local lines).}

\item{use_weights}{Logical; if \code{TRUE} use \code{n} as LOESS weights.}

\item{std_mode}{One of \code{"robust_global"}, \code{"global_sd"}, or \code{"local_loess"}.
\itemize{
\item \code{robust_global}: global MAD*1.4826
\item \code{global_sd}: global standard deviation
\item \code{local_loess}: LOESS on \code{abs(resid)} to get a local sigma
}}

\item{span_scale}{LOESS span used only for the \code{local_loess} sigma fit.}
}
\value{
The input table with added columns:
\itemize{
\item \code{y_hat}: LOESS fitted value at each \code{x}
\item \code{resid}: raw residual \code{y - y_hat}
\item \code{ESRz}: standardized residual (z-like score)
}
}
\description{
Fit a LOESS trend \code{y ~ x}, compute residuals \code{resid = y - y_hat}, and
standardize them to unit-free z-like scores \code{ESRz}.
}
\examples{
out <- MRCAs(Halo_DF, Halo_FocalClades) |> computeESR()
head(out)

}
\author{
Anika Mittal
}
